= API Reference
:toc: left
:toclevels: 3
:icons: font
:source-highlighter: highlight.js
:homepage: https://github.com/debugOSS/xml2jdto

link:index.html[‚Üê Back to Home]

== Overview

This document provides a complete API reference for XML2JDTO core classes and methods.

== Core Classes

=== JaxbUtil

The main utility class for JAXB operations. All methods are static and thread-safe.

**Package**: `io.github.debug.xml2jdto.core.jaxb`

**Thread Safety**: Thread-safe with internal caching mechanisms.

==== Constants

===== CLAZZ_NULL_MSG
[source,java]
----
public static final String CLAZZ_NULL_MSG = "clazz cannot be null!"
----

Error message used when a required class parameter is null.

===== DEFAULT_MARSHALLER_PROPERTIES
[source,java]
----
public static final Map<String, Object> DEFAULT_MARSHALLER_PROPERTIES
----

Default properties applied to JAXB marshallers:

* `Marshaller.JAXB_ENCODING`: UTF-8
* `Marshaller.JAXB_FORMATTED_OUTPUT`: false
* `Marshaller.JAXB_FRAGMENT`: false

==== JAXBContext Methods

===== getJAXBContext(Class)
[source,java]
----
public static JAXBContext getJAXBContext(Class<?> clazz)
----

Retrieves a cached `JAXBContext` for the given class, or creates and caches a new one if not present.

**Parameters**:

* `clazz` - The class for which to retrieve the JAXBContext

**Returns**: The JAXBContext for the specified class

**Throws**:

* `InvalidMethodParameterException` - if clazz is null
* `Xml2jDtoException` - if an error occurs creating the JAXBContext

**Example**:
[source,java]
----
JAXBContext context = JaxbUtil.getJAXBContext(Person.class);
----

===== getJAXBContext(Class...)
[source,java]
----
public static JAXBContext getJAXBContext(Class<?>... forClasses)
----

Retrieves a cached `JAXBContext` for multiple classes, or creates and caches a new one if not present.

**Parameters**:

* `forClasses` - Variable number of classes to be bound by the JAXBContext

**Returns**: The JAXBContext for the specified classes

**Throws**:

* `InvalidParameterException` - if forClasses is null
* `Xml2jDtoException` - if an error occurs creating the JAXBContext

**Example**:
[source,java]
----
JAXBContext context = JaxbUtil.getJAXBContext(Person.class, Address.class);
----

==== Unmarshal Methods

===== unmarshal(String, Class)
[source,java]
----
public static <T> T unmarshal(String xml, Class<T> clazz)
----

Unmarshals an XML string into a Java object without schema validation.

**Type Parameters**:

* `T` - The type of object to return

**Parameters**:

* `xml` - The XML string to unmarshal
* `clazz` - The class of the object to return

**Returns**: The unmarshalled object of type T, or null if xml is blank

**Throws**:

* `InvalidMethodParameterException` - if clazz is null
* `Xml2jDtoException` - if an error occurs during unmarshalling

**Example**:
[source,java]
----
String xml = "<person><name>John</name></person>";
Person person = JaxbUtil.unmarshal(xml, Person.class);
----

===== unmarshal(String, Class, String)
[source,java]
----
public static <T> T unmarshal(String xml, Class<T> clazz, String xsdPath)
----

Unmarshals an XML string into a Java object with optional schema validation.

**Type Parameters**:

* `T` - The type of object to return

**Parameters**:

* `xml` - The XML string to unmarshal
* `clazz` - The class of the object to return
* `xsdPath` - Path to the XSD schema file (null for no validation)

**Returns**: The unmarshalled object of type T, or null if xml is null

**Throws**:

* `InvalidMethodParameterException` - if clazz is null
* `InvalidXmlSchemaException` - if XML validation against schema fails
* `MalformedXmlException` - if the XML is malformed
* `Xml2jDtoException` - if another error occurs during unmarshalling

**Example**:
[source,java]
----
String xml = "<person><name>John</name></person>";
Person person = JaxbUtil.unmarshal(xml, Person.class, "schemas/person.xsd");
----

===== unmarshal(InputStream, Class, String)
[source,java]
----
public static <T> T unmarshal(InputStream xmlInputStream, Class<T> clazz, String xsdPath)
----

Unmarshals an XML input stream into a Java object with optional schema validation.

**Type Parameters**:

* `T` - The type of object to return

**Parameters**:

* `xmlInputStream` - The input stream containing XML data
* `clazz` - The class of the object to return
* `xsdPath` - Path to the XSD schema file (null for no validation)

**Returns**: The unmarshalled object of type T, or null if xmlInputStream is null

**Throws**:

* `InvalidParameterException` - if clazz is null
* `InvalidXmlSchemaException` - if XML validation against schema fails
* `MalformedXmlException` - if the XML is malformed
* `Xml2jDtoException` - if another error occurs during unmarshalling

**Example**:
[source,java]
----
try (InputStream is = new FileInputStream("person.xml")) {
    Person person = JaxbUtil.unmarshal(is, Person.class, null);
}
----

==== Marshal Methods

===== marshal(T)
[source,java]
----
public static <T> String marshal(T dto)
----

Marshals a Java object into an XML string using default properties (compact format).

**Type Parameters**:

* `T` - The type of the DTO object

**Parameters**:

* `dto` - The object to marshal

**Returns**: XML string representation, or null if dto is null

**Example**:
[source,java]
----
Person person = new Person("John", 30);
String xml = JaxbUtil.marshal(person);
----

===== marshalFormatted(T)
[source,java]
----
public static <T> String marshalFormatted(T dto)
----

Marshals a Java object into a formatted (human-readable) XML string.

**Type Parameters**:

* `T` - The type of the DTO object

**Parameters**:

* `dto` - The object to marshal

**Returns**: Formatted XML string, or null if dto is null

**Example**:
[source,java]
----
Person person = new Person("John", 30);
String xml = JaxbUtil.marshalFormatted(person);
// Produces formatted, indented XML
----

===== marshal(T, Map)
[source,java]
----
public static <T> String marshal(T dto, Map<String, Object> properties)
----

Marshals a Java object into an XML string with custom marshaller properties.

**Type Parameters**:

* `T` - The type of the DTO object

**Parameters**:

* `dto` - The object to marshal
* `properties` - Map of marshaller properties (can be null)

**Returns**: XML string representation, or null if dto is null

**Throws**:

* `Xml2jDtoException` - if an error occurs during marshalling

**Example**:
[source,java]
----
Map<String, Object> props = new HashMap<>();
props.put(Marshaller.JAXB_FORMATTED_OUTPUT, true);
props.put(Marshaller.JAXB_ENCODING, "UTF-8");

String xml = JaxbUtil.marshal(person, props);
----

===== marshal(T, String)
[source,java]
----
public static <T> String marshal(T dto, String schemaPath)
----

Marshals a Java object into an XML string with schema validation.

**Type Parameters**:

* `T` - The type of the DTO object

**Parameters**:

* `dto` - The object to marshal
* `schemaPath` - Path to the XSD schema file for validation

**Returns**: XML string representation, or null if dto is null

**Throws**:

* `InvalidXmlSchemaException` - if validation against schema fails
* `MalformedXmlException` - if marshalling fails
* `Xml2jDtoException` - if another error occurs

**Example**:
[source,java]
----
String xml = JaxbUtil.marshal(person, "schemas/person.xsd");
----

===== marshal(T, String, Map, Class...)
[source,java]
----
public static <T> String marshal(T dto, String schemaPath, 
                                 Map<String, Object> marshallerProperties,
                                 Class<?>... additionalClasses)
----

Marshals a Java object to XML with full customization options.

**Type Parameters**:

* `T` - The type of the DTO object

**Parameters**:

* `dto` - The object to marshal
* `schemaPath` - Path to XSD schema (blank for no validation)
* `marshallerProperties` - Custom marshaller properties
* `additionalClasses` - Additional classes for JAXB context

**Returns**: XML string representation, or null if dto is null

**Throws**:

* `InvalidXmlSchemaException` - if validation fails
* `MalformedXmlException` - if marshalling fails
* `Xml2jDtoException` - if another error occurs

**Example**:
[source,java]
----
Map<String, Object> props = Map.of(
    Marshaller.JAXB_FORMATTED_OUTPUT, true
);

String xml = JaxbUtil.marshal(person, "schemas/person.xsd", props, Address.class);
----

==== Schema Methods

===== getSchema(String)
[source,java]
----
public static Schema getSchema(String xsdPath)
----

Retrieves a cached `Schema` object or loads and caches it from the specified XSD path.

**Parameters**:

* `xsdPath` - Path to the XSD file in the classpath

**Returns**: The Schema object for the XSD file

**Throws**:

* `InvalidMethodParameterException` - if xsdPath is blank
* `Xml2jDtoException` - if the schema cannot be loaded

**Example**:
[source,java]
----
Schema schema = JaxbUtil.getSchema("schemas/person.xsd");
----

===== loadSchemaFromXsdPath(String, LSResourceResolver)
[source,java]
----
public static Schema loadSchemaFromXsdPath(String xsdPath, 
                                           LSResourceResolver lsResourceResolver)
----

Loads a Schema from an XSD path using a custom resource resolver.

**Parameters**:

* `xsdPath` - Path to the XSD file
* `lsResourceResolver` - Resource resolver for schema dependencies

**Returns**: The loaded Schema object

**Throws**:

* `InvalidMethodParameterException` - if parameters are invalid
* `Xml2jDtoException` - if schema loading fails

== Exception Classes

=== Xml2jDtoException

Base exception class for all XML2JDTO operations.

**Package**: `io.github.debug.xml2jdto.core.exception`

**Extends**: `RuntimeException`

**Constructor**:
[source,java]
----
public Xml2jDtoException(String message)
public Xml2jDtoException(String message, Throwable cause)
----

=== MalformedXmlException

Thrown when XML structure is invalid or cannot be parsed.

**Package**: `io.github.debug.xml2jdto.core.exception`

**Extends**: `Xml2jDtoException`

**Methods**:

* `getEvents()` - Returns list of validation events
* `getValidationException()` - Returns the underlying JAXBException

**Example**:
[source,java]
----
try {
    Person person = JaxbUtil.unmarshal(invalidXml, Person.class);
} catch (MalformedXmlException e) {
    System.err.println("Malformed XML: " + e.getMessage());
    e.getEvents().forEach(event -> 
        System.err.println("  Error: " + event.getMessage())
    );
}
----

=== InvalidXmlSchemaException

Thrown when XML fails schema validation.

**Package**: `io.github.debug.xml2jdto.core.exception`

**Extends**: `Xml2jDtoException`

**Constructor**:
[source,java]
----
public InvalidXmlSchemaException(List<ValidationEvent> events)
----

**Methods**:

* `getEvents()` - Returns list of validation events with detailed error information

**Example**:
[source,java]
----
try {
    Person person = JaxbUtil.unmarshal(xml, Person.class, "schemas/person.xsd");
} catch (InvalidXmlSchemaException e) {
    System.err.println("Schema validation failed:");
    e.getEvents().forEach(event -> {
        System.err.println("  Line " + event.getLocator().getLineNumber() + 
                          ": " + event.getMessage());
    });
}
----

=== InvalidMethodParameterException

Thrown when invalid parameters are passed to API methods.

**Package**: `io.github.debug.xml2jdto.core.exception`

**Extends**: `Xml2jDtoException`

**Constructor**:
[source,java]
----
public InvalidMethodParameterException(String message)
----

== Catalog Classes

=== CatalogConfig

Manages catalog path configuration from system properties or environment variables.

**Package**: `io.github.debug.xml2jdto.core.jaxb.catalog`

==== Methods

===== getCatalogPaths()
[source,java]
----
public List<String> getCatalogPaths()
----

Retrieves catalog paths from system property `xml2jdto.catalog.path` or environment variable.

**Returns**: List of catalog paths, or null if not configured

===== setCatalogPaths(List)
[source,java]
----
public void setCatalogPaths(List<String> catalogPaths)
----

Sets the catalog paths programmatically.

**Parameters**:

* `catalogPaths` - List of catalog file paths

=== CatalogResourceResolver

Resolves XML schema resources using XML Catalog files.

**Package**: `io.github.debug.xml2jdto.core.jaxb.catalog`

**Implements**: `LSResourceResolver`

==== Constructor
[source,java]
----
public CatalogResourceResolver()
public CatalogResourceResolver(CatalogConfig catalogConfig)
----

=== CatalogProducer

Factory class for creating XML Catalog instances.

**Package**: `io.github.debug.xml2jdto.core.jaxb.catalog`

==== Methods

===== produceCatalogFromPaths(List)
[source,java]
----
public static CatalogResolver produceCatalogFromPaths(List<String> catalogPaths)
----

Creates a catalog resolver from a list of catalog file paths.

**Parameters**:

* `catalogPaths` - List of paths to catalog XML files

**Returns**: CatalogResolver instance

=== XsdValidationEventCollector

Collects validation events during marshalling and unmarshalling operations.

**Package**: `io.github.debug.xml2jdto.core.jaxb.event`

**Implements**: `ValidationEventHandler`

==== Methods

===== getEvents()
[source,java]
----
public List<ValidationEvent> getEvents()
----

Returns the collected validation events.

**Returns**: List of ValidationEvent objects

== Utility Classes

=== ExBuilder

Builder class for creating XML2JDTO exceptions with formatted messages.

**Package**: `io.github.debug.xml2jdto.core.exception`

==== Methods

===== newXml2jDtoException()
[source,java]
----
public static ExBuilder<Xml2jDtoException> newXml2jDtoException()
----

Creates a new exception builder for Xml2jDtoException.

**Example**:
[source,java]
----
throw ExBuilder.newXml2jDtoException()
    .withMessage("Error processing {0}", fileName)
    .withCause(originalException)
    .build();
----

===== withMessage(String, Object...)
[source,java]
----
public ExBuilder<E> withMessage(String pattern, Object... arguments)
----

Sets the exception message using MessageFormat pattern.

===== withCause(Throwable)
[source,java]
----
public ExBuilder<E> withCause(Throwable cause)
----

Sets the cause of the exception.

===== build()
[source,java]
----
public E build()
----

Builds and returns the exception instance.

== Usage Examples

=== Complete Type-Safe Example

[source,java]
----
import io.github.debug.xml2jdto.core.jaxb.JaxbUtil;
import io.github.debug.xml2jdto.core.exception.*;
import jakarta.xml.bind.Marshaller;
import java.util.Map;

public class CompleteExample {
    public void processXml() {
        // 1. Get JAXBContext (cached automatically)
        JAXBContext context = JaxbUtil.getJAXBContext(Person.class);
        
        // 2. Unmarshal with validation
        try {
            Person person = JaxbUtil.unmarshal(
                xmlString, 
                Person.class, 
                "schemas/person.xsd"
            );
            
            // 3. Process the object
            person.setAge(person.getAge() + 1);
            
            // 4. Marshal with custom properties
            Map<String, Object> props = Map.of(
                Marshaller.JAXB_FORMATTED_OUTPUT, true,
                Marshaller.JAXB_ENCODING, "UTF-8"
            );
            
            String output = JaxbUtil.marshal(person, "schemas/person.xsd", props);
            
        } catch (InvalidXmlSchemaException e) {
            handleSchemaError(e);
        } catch (MalformedXmlException e) {
            handleMalformedXml(e);
        } catch (Xml2jDtoException e) {
            handleGeneralError(e);
        }
    }
    
    private void handleSchemaError(InvalidXmlSchemaException e) {
        e.getEvents().forEach(event -> 
            log.error("Validation error at line {}: {}", 
                event.getLocator().getLineNumber(),
                event.getMessage())
        );
    }
    
    private void handleMalformedXml(MalformedXmlException e) {
        log.error("Malformed XML: {}", e.getMessage());
        if (e.getValidationException() != null) {
            log.error("Cause: {}", e.getValidationException().getMessage());
        }
    }
    
    private void handleGeneralError(Xml2jDtoException e) {
        log.error("XML processing error: {}", e.getMessage(), e);
    }
}
----

== Next Steps

* link:advanced-features.html[Advanced Features] - Learn about catalogs and advanced validation
* link:examples.html[Examples] - See real-world usage examples
* link:configuration.html[Configuration] - Configure catalog paths and system properties
